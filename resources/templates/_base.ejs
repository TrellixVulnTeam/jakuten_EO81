<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    
    <title>Jakuten Store</title>
    
    <link rel="stylesheet" type="text/css" href="/css/bootstrap.css">
    <style type="text/css">
    .bs-component + .bs-component {
        margin-top: 1rem;
    }
    @media (min-width: 768px) {
        .bs-docs-section {
        margin-top: 8em;
        }
        .bs-component {
        position: relative;
        }
        .bs-component .modal {
        position: relative;
        top: auto;
        right: auto;
        bottom: auto;
        left: auto;
        z-index: 1;
        display: block;
        }
        .bs-component .modal-dialog {
        width: 90%;
        }
        .bs-component .popover {
        position: relative;
        display: inline-block;
        width: 220px;
        margin: 20px;
        }
        .nav-tabs {
        margin-bottom: 15px;
        }
        .progress {
        margin-bottom: 10px;
        }
    }

    @font-face {
        font-family: "Yu Gothic";
        src: local("Yu Gothic Medium");
        font-weight: 100;
    }
    @font-face {
        font-family: "Yu Gothic";
        src: local("Yu Gothic Medium");
        font-weight: 200;
    }
    @font-face {
        font-family: "Yu Gothic";
        src: local("Yu Gothic Medium");
        font-weight: 300;
    }
    @font-face {
        font-family: "Yu Gothic";
        src: local("Yu Gothic Medium");
        font-weight: 400;
    }
    @font-face {
        font-family: "Yu Gothic";
        src: local("Yu Gothic Bold");
        font-weight: bold;
    }
    @font-face {
        font-family: "Helvetica Neue";
        src: local("Helvetica Neue Regular");
        font-weight: 100;
    }
    @font-face {
        font-family: "Helvetica Neue";
        src: local("Helvetica Neue Regular");
        font-weight: 200;
    }
    body, tooltip, popover {
        font-family: -apple-system, BlinkMacSystemFont, "Helvetica Neue", "Yu Gothic", YuGothic, Verdana, Meiryo, "M+ 1p", sans-serif;
    }
    @media all and (-ms-high-contrast: none) {
        body, tooltip, popover {
            font-family: Verdana, Meiryo, sans-serif;
        }
    }

    </style>

	<!--[if lt IE 9]>
		<script src="//oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
		<script src="//oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
	<![endif]-->
    <script src="/js/jquery.min.js"></script>
    <script src="/js/bootstrap.bundle.min.js"></script>
    
</head>
<body>
<header>
</header>

<nav class="navbar navbar-expand-lg navbar-dark fixed-top" style="background-color: #102030; opacity: 0.9;">
    <a class="navbar-brand" href="/">
        <img src="data:image/svg+xml,%3Csvg%20id%3D%22aae16133-9bdf-4745-aeb2-eaf9e357bec0%22%20data-name%3D%22%E3%83%AC%E3%82%A4%E3%83%A4%E3%83%BC%201%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20viewBox%3D%220%200%20129.66%20117.14%22%3E%3Cdefs%3E%3Cstyle%3E.b26216d2-ffa3-449e-b9cd-b5da6b0ad965%7Bfill%3A%23fff%3B%7D.ddf4149c-50b4-4cde-a4a4-bb066597dc81%7Bfill%3A%231aa4c9%3B%7D.%5C35%20add4185-29e0-4da5-9e77-007513873841%7Bfill%3A%23405461%3B%7D.d6f2d54c-80b9-4536-b01d-6e399bce5f54%7Bfill%3A%23e4007f%3B%7D%3C%2Fstyle%3E%3C%2Fdefs%3E%3Ctitle%3E%E5%90%8D%E7%A7%B0%E6%9C%AA%E8%A8%AD%E5%AE%9A-1%3C%2Ftitle%3E%3Cpolygon%20class%3D%22b26216d2-ffa3-449e-b9cd-b5da6b0ad965%22%20points%3D%22129.66%2035.82%20108.98%200%2067.62%200%2060.15%2012.94%2030.08%2012.94%200%2065.04%2030.08%20117.14%2090.23%20117.14%20120.31%2065.04%20116.55%2058.52%20129.66%2035.82%22%2F%3E%3Cpath%20class%3D%22ddf4149c-50b4-4cde-a4a4-bb066597dc81%22%20d%3D%22M107.25%2C68.64H85.36c-.63%2C1.94-1.36%2C4-2.19%2C6a74.34%2C74.34%2C0%2C0%2C1-4.66%2C9.59A61.62%2C61.62%2C0%2C0%2C1%2C72.4%2C93%2C34.27%2C34.27%2C0%2C0%2C1%2C65%2C99.67a21%2C21%2C0%2C0%2C1-2.2%2C1.16%2C19.21%2C19.21%2C0%2C0%2C1-2.75%2C1%2C26.32%2C26.32%2C0%2C0%2C1-3.14.68%2C20.23%2C20.23%2C0%2C0%2C1-3.28.26%2C26.23%2C26.23%2C0%2C0%2C1-5.89-.73%2C39%2C39%2C0%2C0%2C1-6.36-2.09%2C40.38%2C40.38%2C0%2C0%2C1-6.15-3.28A30.48%2C30.48%2C0%2C0%2C1%2C30%2C92.42a20%2C20%2C0%2C0%2C1-3.66-5A12.15%2C12.15%2C0%2C0%2C1%2C25%2C81.82a14.7%2C14.7%2C0%2C0%2C1%2C.44-3.88%2C5.89%2C5.89%2C0%2C0%2C1%2C1.44-2.62%2C6%2C6%2C0%2C0%2C1%2C2.65-1.46%2C14.46%2C14.46%2C0%2C0%2C1%2C4-.48%2C1.6%2C1.6%2C0%2C0%2C1%2C1.34.66%2C4.85%2C4.85%2C0%2C0%2C1%2C.76%2C1.6%2C11.27%2C11.27%2C0%2C0%2C1%2C.34%2C2c0%2C.73.08%2C1.41.08%2C2v2a34.85%2C34.85%2C0%2C0%2C0%2C2.8%2C3.75%2C27.41%2C27.41%2C0%2C0%2C0%2C3.9%2C3.77%2C22.94%2C22.94%2C0%2C0%2C0%2C4.79%2C2.93A13.14%2C13.14%2C0%2C0%2C0%2C53%2C93.34a12.31%2C12.31%2C0%2C0%2C0%2C5.89-1.47A20.74%2C20.74%2C0%2C0%2C0%2C64%2C88a34%2C34%2C0%2C0%2C0%2C4.35-5.58A60.62%2C60.62%2C0%2C0%2C0%2C72%2C75.87c1.06-2.25%2C2-4.49%2C2.83-6.73l.18-.5H69.35L50.4%2C35.82%2C61.88%2C15.94H31.81L3.46%2C65l28.35%2C49.1H88.5L116.85%2C65l-3.76-6.52Z%22%2F%3E%3Cpath%20class%3D%225add4185-29e0-4da5-9e77-007513873841%22%20d%3D%22M91%2C20.22l3.93-1q2.75-.68%2C5.16-1.25c.1%2C0%2C.45-.13%2C1-.27l2-.44%2C2.1-.45a8.16%2C8.16%2C0%2C0%2C1%2C1.31-.21%2C2%2C2%2C0%2C0%2C1%2C1.15.37%2C2.91%2C2.91%2C0%2C0%2C1%2C.86.92%2C4.93%2C4.93%2C0%2C0%2C1%2C.55%2C1.25%2C4.71%2C4.71%2C0%2C0%2C1%2C.21%2C1.34%2C3.64%2C3.64%2C0%2C0%2C1-1.2%2C2.72%2C11.41%2C11.41%2C0%2C0%2C1-3%2C2%2C30.58%2C30.58%2C0%2C0%2C1-4%2C1.52c-1.45.43-2.81.84-4.06%2C1.23-.46.14-.88.27-1.28.41l17.4%2C30.13%2C13.1-22.7L107.25%2C3H69.35L61.88%2C15.94H88.5Z%22%2F%3E%3Cpath%20class%3D%22d6f2d54c-80b9-4536-b01d-6e399bce5f54%22%20d%3D%22M88.3%2C57.33c.58-2.74%2C1.06-5.26%2C1.47-7.57s.71-4.25.94-5.86.37-2.62.44-3c.21-1.71.4-3.51.58-5.39s.35-3.6.52-5.14q.16-.67%2C1.5-1.23c.57-.23%2C1.22-.47%2C1.94-.71L91%2C20.22l-1.6.4L83.87%2C22c-1.81.48-3.52.91-5.13%2C1.31l-4.37%2C1.08c-1.31.31-2.38.56-3.22.73h-.74a25.83%2C25.83%2C0%2C0%2C0-3.82.24%2C5.52%2C5.52%2C0%2C0%2C0-2.54%2C1%2C4.12%2C4.12%2C0%2C0%2C0-1.41%2C2.18%2C13%2C13%2C0%2C0%2C0-.45%2C3.79%2C4.73%2C4.73%2C0%2C0%2C0%2C1.34%2C3.62%2C4.66%2C4.66%2C0%2C0%2C0%2C3.32%2C1.26%2C6.78%2C6.78%2C0%2C0%2C0%2C1.78-.32l13-3.66c.49.1.73.55.73%2C1.36a53.8%2C53.8%2C0%2C0%2C1-1%2C10q-1%2C5.09-2.33%2C10.63c-.14.53-.39%2C1.48-.74%2C2.86s-.82%2C3-1.41%2C4.89S75.71%2C66.6%2C75%2C68.64H85.36c.35-1.09.69-2.17%2C1-3.22C87.07%2C62.77%2C87.72%2C60.07%2C88.3%2C57.33Z%22%2F%3E%3C%2Fsvg%3E" height="60px" />
    </a>
    <div class="navbar-collapse collapse" id="navbar">
        <a class="navbar-brand" href="/">
            弱天
        </a>
        <ul class="navbar-nav mr-auto">
            <li class="nav-item dropdown active">
                <a class="nav-link dropdown-toggle" href="#" id="navbarDropdownCat" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                    商品カテゴリ
                </a>
                <div class="dropdown-menu" aria-labelledby="navbarDropdownCat">
                    <a class="dropdown-item" href="/cat/food">食品・ドリンク</a>
                    <a class="dropdown-item" href="/cat/interior">Tシャツ</a>
                </div>
            </li>
        </ul>
        <ul class="nav navbar-nav navbar-right">
            <li class="nav-item"><a class="nav-link" href="#">配送</a></li>
            <li class="nav-item"><a class="nav-link" href="#">会社概要</a></li>
            <% if(session && session.user && session.user.id) { %>
            <li class="nav-item dropdown active">
                <a class="nav-link dropdown-toggle" href="#" id="navbarDropdownUser" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                    <%- session.user.display_name %> 様<span class="caret">
                </a>
                <div class="dropdown-menu" aria-labelledby="navbarDropdownUser">
                    <a class="dropdown-item" href="/profile/<%- session.user.id %>">プロフィール</a>
                    <a class="dropdown-item" href="#" data-toggle="modal" data-target="#logoutModal">ログアウト</a>
                </div>
            </li>
            <% }else{ %>
            <li class="nav-item"><a class="nav-link" href="#" data-toggle="modal" data-target="#loginModal">ログイン</a></li>
            <% } %>
        </ul>
    </div>
    <div class="mt-2 mb-2 ml-auto mr-2">
        <% if(session && session.cart && session.cart.count && session.cart.count > 0) { %>
            <a class="d-inline-block" href="/cart">
                <img class="" src="data:image/svg+xml,%3Csvg%20version%3D%221%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%221706.667%22%20height%3D%221436%22%20viewBox%3D%220%200%201280%201077%22%3E%3Cpath%20d%3D%22M41%201.6C23%206.3%208.8%2019.4%202.8%2036.7-.5%2046.3-.4%2062.8%203%2071.5c5%2012.9%2014.1%2023.6%2025%2029.4%2012.6%206.8%209%206.4%2080.5%206.8l65%20.4%2071.4%20285.4c45.1%20180.4%2072.5%20288.3%2074.5%20293.3%209.3%2023%2029%2044.4%2051.1%2055.5%208.8%204.4%2022.7%208.8%2032.5%2010.3%206.4.9%2019.2%201.4%2039%201.5%2016.2.1%2028.2.4%2026.5.6-49.3%205.9-91.6%2031.3-117.7%2070.8-36.6%2055.2-36.7%20125.2-.3%20179.5%2012.2%2018.2%2026.3%2032.2%2044.5%2044.5%2047.4%2031.9%20107.9%2036.2%20159.5%2011.5%2045.7-21.9%2077.8-63%2088.6-113.6%202.1-9.6%202.4-13.5%202.4-32.4-.1-18.3-.4-23-2.3-31.6-14.7-67.6-68.1-118-135.4-127.8-8-1.2%2023-1.4%20219.7-1.4%20194.5%200%20227.6.2%20219.5%201.3-68.2%209.6-121.5%2060.2-136.1%20129.5-3.3%2015.3-3.3%2045.8%200%2061%209.4%2044%2033.1%2079.7%2069%20103.6%2041.7%2027.9%2093%2034.8%20141%2018.8%2055-18.3%2095.7-64.8%20107.3-122.7%203.3-16.2%203.2-44.3%200-60.5-13.9-68.9-67.6-119.9-136.7-129.7-8.6-1.2-7.6-1.3%2021-1.4%2041.3-.2%2053.4-2.2%2072.9-12.4%2023.2-12%2042.7-33.7%2051.2-56.7%202.7-7.4%20143.2-522.4%20142.7-523.3-.6-.9-901-.9-901.7.1-.2.4%205.5%2024.7%2012.7%2054l13.2%2053.2h367.8c202.2%200%20367.7.1%20367.7.2-.1.2-23.2%2084.9-51.4%20188.3l-51.3%20188-308.6.3-308.6.2-1-3.7c-.6-2.1-32.5-129.9-71-284S275.7%2074.5%20274.1%2070C263%2039.6%20237.2%2015.1%20205.9%205.1%20190.7.2%20186.2%200%20114.1.1%2058.4.1%2045.5.4%2041%201.6zM500.1%20864c32.1%209.9%2047.5%2045.5%2032.6%2075.3-9.2%2018.5-27.2%2029.7-47.7%2029.7-29.9%200-54-24-54-53.7%200-23.7%2018.1-46.9%2040.6-52.2%207.3-1.7%2021.7-1.3%2028.5.9zm484-.4c18.2%205.3%2032.7%2020.1%2037.4%2037.9%201.9%207.6%201.9%2020.4%200%2028-4.4%2016.7-18.5%2031.6-35.1%2037.1-8.2%202.7-25.6%202.7-33.8%200-14.4-4.8-27.2-17-33.3-31.9-3.1-7.5-4.2-22.1-2.3-31%203.8-18.3%2019.8-35.2%2038.1-40.1%207.4-2%2022.2-2%2029%200z%22%20fill%3D%22%23cceeff%22%2F%3E%3C%2Fsvg%3E" height="30px" />
                <span class="badge badge-danger" style="margin-left: -10px"><%- session.cart.count %></span>
            </a>
        <% }else{ %>
            <img class="" src="data:image/svg+xml,%3Csvg%20version%3D%221%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%221706.667%22%20height%3D%221436%22%20viewBox%3D%220%200%201280%201077%22%3E%3Cpath%20d%3D%22M41%201.6C23%206.3%208.8%2019.4%202.8%2036.7-.5%2046.3-.4%2062.8%203%2071.5c5%2012.9%2014.1%2023.6%2025%2029.4%2012.6%206.8%209%206.4%2080.5%206.8l65%20.4%2071.4%20285.4c45.1%20180.4%2072.5%20288.3%2074.5%20293.3%209.3%2023%2029%2044.4%2051.1%2055.5%208.8%204.4%2022.7%208.8%2032.5%2010.3%206.4.9%2019.2%201.4%2039%201.5%2016.2.1%2028.2.4%2026.5.6-49.3%205.9-91.6%2031.3-117.7%2070.8-36.6%2055.2-36.7%20125.2-.3%20179.5%2012.2%2018.2%2026.3%2032.2%2044.5%2044.5%2047.4%2031.9%20107.9%2036.2%20159.5%2011.5%2045.7-21.9%2077.8-63%2088.6-113.6%202.1-9.6%202.4-13.5%202.4-32.4-.1-18.3-.4-23-2.3-31.6-14.7-67.6-68.1-118-135.4-127.8-8-1.2%2023-1.4%20219.7-1.4%20194.5%200%20227.6.2%20219.5%201.3-68.2%209.6-121.5%2060.2-136.1%20129.5-3.3%2015.3-3.3%2045.8%200%2061%209.4%2044%2033.1%2079.7%2069%20103.6%2041.7%2027.9%2093%2034.8%20141%2018.8%2055-18.3%2095.7-64.8%20107.3-122.7%203.3-16.2%203.2-44.3%200-60.5-13.9-68.9-67.6-119.9-136.7-129.7-8.6-1.2-7.6-1.3%2021-1.4%2041.3-.2%2053.4-2.2%2072.9-12.4%2023.2-12%2042.7-33.7%2051.2-56.7%202.7-7.4%20143.2-522.4%20142.7-523.3-.6-.9-901-.9-901.7.1-.2.4%205.5%2024.7%2012.7%2054l13.2%2053.2h367.8c202.2%200%20367.7.1%20367.7.2-.1.2-23.2%2084.9-51.4%20188.3l-51.3%20188-308.6.3-308.6.2-1-3.7c-.6-2.1-32.5-129.9-71-284S275.7%2074.5%20274.1%2070C263%2039.6%20237.2%2015.1%20205.9%205.1%20190.7.2%20186.2%200%20114.1.1%2058.4.1%2045.5.4%2041%201.6zM500.1%20864c32.1%209.9%2047.5%2045.5%2032.6%2075.3-9.2%2018.5-27.2%2029.7-47.7%2029.7-29.9%200-54-24-54-53.7%200-23.7%2018.1-46.9%2040.6-52.2%207.3-1.7%2021.7-1.3%2028.5.9zm484-.4c18.2%205.3%2032.7%2020.1%2037.4%2037.9%201.9%207.6%201.9%2020.4%200%2028-4.4%2016.7-18.5%2031.6-35.1%2037.1-8.2%202.7-25.6%202.7-33.8%200-14.4-4.8-27.2-17-33.3-31.9-3.1-7.5-4.2-22.1-2.3-31%203.8-18.3%2019.8-35.2%2038.1-40.1%207.4-2%2022.2-2%2029%200z%22%20fill%3D%22%23cceeff%22%2F%3E%3C%2Fsvg%3E" height="30px" />
            <span class="badge badge-danger" style="margin-left: -10px; display: none"></span>
        <% } %>
    </div>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
    </button>
</nav>

<%# ログイン・登録モーダル %>
<% if(!session || !session.user || !session.user.id) { %>

<div class="modal" tabindex="-1" role="dialog" id="loginModal">
    <form>
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">ログイン</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                            <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <fieldset>
                    <div class="modal-body">
                        <div class="form-group">
                            <label for="inputEmail">メールアドレス</label>
                            <input type="email" class="form-control" id="inputEmail" placeholder="you@example.com" required>
                        </div>
                        <div class="form-group">
                            <label for="inputEmail">パスワード</label>
                            <input type="password" class="form-control" id="inputPassword" placeholder="Password" required>
                        </div>
                    </div>
                    <div class="modal-footer">  
                        <div style="text-align: right">
                            <button type="reset" class="btn btn-secondary">リセット</button>
                            <button type="submit" class="btn btn-primary" id="submitLogin">送信</button>
                        </div>
                    </div>
                    <div class="modal-footer">  
                        <button type="button" class="btn btn-info btn-block" data-toggle="modal" data-target="#registerModal" data-dismiss="modal" aria-label="Close">新規登録</button>
                    </div>
                </fieldset>
            </div>
        </div>
    </form>
</div>

<div class="modal" tabindex="-1" role="dialog" id="registerModal">
    <form id="registerForm">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="registerModalTitle">新規会員登録</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                            <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <div id="registerConfirmationAlert" class="alert alert-info" style="display: none">下記の内容で登録します。よろしいですか？</div>
                    <div id="registerErrorAlert" class="alert alert-danger" style="display: none"></div>
                    <fieldset id="registerFieldSet">
                        <div class="form-group">
                            <label for="inputEmail">メールアドレス</label>
                            <input type="email" class="form-control" id="registerEmail" placeholder="you@example.com" required />
                        </div>
                        <div class="form-group">
                            <label for="inputEmail">パスワード</label>
                            <div class="row">
                                <div class="col"><input type="password" class="form-control" id="registerPassword" placeholder="12文字以上" required /></div>
                                <div class="col"><input type="password" class="form-control" id="registerPasswordConfirm" placeholder="確認" required /></div>
                            </div>
                        </div>
                        <hr />
                        <div class="form-group">
                            <label for="">お名前</label>
                            <div class="row">
                                <div class="col"><input type="text" class="form-control" id="registerFamilyName" placeholder="姓" required></div>
                                <div class="col"><input type="text" class="form-control" id="registerFirstName" placeholder="名" required></div>
                            </div>
                            <label for="">よみがな</label>
                            <div class="row">
                                <div class="col"><input type="text" class="form-control" id="registerFamilyNameKana" placeholder="セイ" required></div>
                                <div class="col"><input type="text" class="form-control" id="registerFirstNameKana" placeholder="メイ" required></div>
                            </div>
                        </div>
                    </fieldset>
                </div>
                <div class="modal-footer" id="inputRegister">
                    <button type="button" class="btn btn-secondary" id="resetRegister" data-toggle="modal" data-target="#loginModal" data-dismiss="modal" aria-label="Close">戻る</button>
                    <button type="submit" class="btn btn-primary" id="submitRegister" onsubmit="return false;">次へ</button>
                </div>
                <div class="modal-footer" id="confirmRegister" style="display: none">
                    <button type="button" class="btn btn-secondary" id="resetConfirm">修正</button>
                    <button type="button" class="btn btn-primary" id="submitConfirm">登録</button>
                </div>
            </div>
        </div>
    </form>
</div>

<script type="text/javascript">
    $(function(){
        $('#submitLogin').on('click',function(){
            $.ajax({
                url:'/api/login',
                type:'POST',
                data:{
                    'email':$('#inputEmail').val(),
                    'password':$('#inputPassword').val()
                }
            })
            .done( (data) => {
                $('.result').html(data);
                console.log(data);
                location.reload();
            })
            .fail( (data) => {
                $('.result').html(data);
                console.log(data);
            })
            .always( (data) => {
            });
            return false;
        });
    });
    $(function(){
        $('#registerPasswordConfirm').on('input',function(){
            var $password = $('#registerPassword')[0];
            var $confirm = $('#registerPasswordConfirm')[0];
            console.log($password);
            if($password.value == $confirm.value){
                $confirm.setCustomValidity('');
            }else{
                $confirm.setCustomValidity('パスワードが確認と異なります');
            }
        });
    });
    $(function(){
        $('#registerForm').on('submit', function(event){
            event.preventDefault();
            var passwordInput = $('#registerPasswordConfirm')[0];
            $('#registerFieldSet input').addClass('form-control-plaintext');
            $('#registerModalTitle').text('登録内容確認');
            $('#confirmRegister').css('display', 'flex');
            $('#inputRegister').css('display', 'none');
            $('#registerConfirmationAlert').css('display', 'block');
            $('#registerErrorAlert').css('display', 'none');
            return false;
        });
    });
    $(function(){
        $('#resetConfirm').on('click',function(){
            $('#registerFieldSet input').removeClass('form-control-plaintext');
            $('#registerModalTitle').text('新規会員登録');
            $('#confirmRegister').css('display', 'none');
            $('#inputRegister').css('display', 'flex');
            $('#registerConfirmationAlert').css('display', 'none');
            $('#registerErrorAlert').css('display', 'none');
            return false;
        });
    });
    $(function(){
        $('#submitConfirm').on('click',function(){
            $.ajax({
                url:'/api/register',
                type:'POST',
                data:{
                    'email':$('#registerEmail').val(),
                    'password':$('#registerPassword').val(),
                    'first_name':$('#registerFirstName').val(),
                    'family_name':$('#registerFamilyName').val(),
                    'first_name_kana':$('#registerFirstNameKana').val(),
                    'family_name_kana':$('#registerFamilyNameKana').val()
                }
            })
            .done( (data) => {
                $('.result').html(data);
                console.log(data);
                location.reload();
            })
            .fail( (data) => {
                $('.result').html(data);
                $('#registerErrorAlert').css('display', 'block');
                $('#registerErrorAlert').text(data.responseJSON.error);
                $('#registerFieldSet input').removeClass('form-control-plaintext');
                $('#registerModalTitle').text('新規会員登録');
                $('#confirmRegister').css('display', 'none');
                $('#inputRegister').css('display', 'flex');
                $('#registerConfirmationAlert').css('display', 'none');
                console.log(data);
            })
            .always( (data) => {
            });
            return false;
        });
    });
</script>
<% } %>

<%# ログアウトモーダル %>
<% if(session && session.user && session.user.id) { %>

<div class="modal" tabindex="-1" role="dialog" id="logoutModal">
    <form id="logoutModal">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="registerModalTitle">ログアウト</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                            <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <div id="registerConfirmationAlert" class="alert alert-warning">ログアウトします。よろしいですか？</div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">キャンセル</button>
                    <button type="submit" class="btn btn-primary" id="submitLogout">OK</button>
                </div>
            </div>
        </div>
    </form>
</div>

<script type="text/javascript">
    $(function(){
        // Ajax button click
        $('#submitLogout').on('click',function(){
            $.ajax({
                url:'/api/logout',
                type:'POST',
                data:{}
            })
            .always( (data) => {
                $('.result').html(data);
                console.log(data);
                location.reload();
            });
            return false;
        });
    });
</script>

<% } %>
    
<div style="padding-top: calc(8px*2 + 70px)">
    <%- include(page, {}) %>
</div>


<script type="text/javascript">
    $('.bs-component [data-toggle="popover"]').popover();
    $('.bs-component [data-toggle="tooltip"]').tooltip();
</script>


</body>
</html>
